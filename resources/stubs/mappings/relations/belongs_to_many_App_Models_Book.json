{
    "name": "BelongsToMany Relation Test"
    "description": "Test mapping for Book belongsToMany Tags relation with pivot"
    "source_schema": {
        "columns": {
            "title": {"name": "title", "type": "string"}
            "isbn": {"name": "isbn", "type": "string"}
            "price": {"name": "price", "type": "float"}
            "author_name": {"name": "author_name", "type": "string"}
            "tag_names": {"name": "tag_names", "type": "string"}
            "tag_order": {"name": "tag_order", "type": "int"}
        }
        "total_rows": 10
    }
    "mappings": [
        {
            "model": "App\\Models\\Book"
            "columns": [
                {
                    "source": "title"
                    "target": "title"
                    "transforms": ["trim"]
                    "default": null
                    "validation_rule": "required|string|min:1|max:255"
                }
                {
                    "source": "isbn"
                    "target": "isbn"
                    "transforms": ["trim"]
                    "default": null
                    "validation_rule": "required|string|regex:/^97[89]-\\d{10}$/|unique:books,isbn"
                }
                {
                    "source": "price"
                    "target": "price"
                    "transforms": ["trim"]
                    "default": null
                    "validation_rule": "required|numeric|min:0|max:9999.99"
                }
                {
                    "source": "author_name"
                    "target": "author.name"
                    "transforms": ["trim"]
                    "default": null
                    "validation_rule": null
                        "field": "name"
                        "create_if_missing": true
                    }
                }
                {
                    "source": "tag_names"
                    "target": "tags.*.name"
                    "transforms": ["trim", "split:,", "lower"]
                    "default": null
                    "validation_rule": null
                        "field": "name"
                        "create_if_missing": true
                        "pivot": {
                            "order": "tag_order"
                        }
                    }
                }
            ]
            "options": {
                "unique_key": "isbn"
                "duplicate_strategy": "update"
            }
        }
    ]
    "created_at": "2025-12-18T22:00:00+00:00"
    "updated_at": "2025-12-18T22:00:00+00:00"
}

